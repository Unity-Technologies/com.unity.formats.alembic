# Auto-generated by Recipe Engine, do not modify manually.

# Sign binaries for Alembic on MacOS
sign_binaries_for_alembic_on_macos:
  name: Sign binaries for Alembic on MacOS
  agent:
    image: package-ci/macos-13:default
    type: Unity::VM::osx
    flavor: b1.xlarge
  commands:
  - brick_source: git@github.cds.internal.unity3d.com:unity/macos.cds.ci.code-signing.git@v2.0.8
    variables:
      CERTIFICATE_NAME: apple-developer-id-application-unity-technologies-sf
  - command: |-
      security unlock-keychain -p $UNITY_KEYCHAIN_PASSWORD /Users/$USER/Library/Keychains/login.keychain-db
      codesign --verbose=3 --timestamp --options=runtime --force --sign "$(<certificate_thumbprint.txt)" com.unity.formats.alembic/Runtime/Plugins/x86_64/abci.bundle
      security lock-keychain /Users/$USER/Library/Keychains/login.keychain-db
      codesign --verify --verbose com.unity.formats.alembic/Runtime/Plugins/x86_64/abci.bundle
    timeout: 2
    retries: 3
  artifacts:
    Alembic_SignedBinariesOnMac:
      paths:
      - com.unity.formats.alembic/Runtime/Plugins/x86_64/abci.bundle
  dependencies:
  - path: .yamato/build-alembic-plugins.yml#build_plugins_-_macos-12

# Sign binaries for Alembic on Windows
sign_binaries_for_alembic_on_windows:
  name: Sign binaries for Alembic on Windows
  agent:
    image: package-ci/win10:default
    type: Unity::VM
    flavor: b1.large
  commands:
  - brick_source: git@github.cds.internal.unity3d.com:unity/batch.cds.ci.code-signing.git@v2.0.8
    variables:
      AZURE_VAULT_URI: https://unity-cs-kv-euw1-prd.vault.azure.net/
      AZURE_CERTIFICATE: ev-unity-technologies-sf
      FILE_LIST: windows_codesign_list.txt
  - command: python Tools/Scripts/verify_win_executables_signed.py --architecture x64 --codesign-list-file windows_codesign_list.txt
  artifacts:
    Alembic_SignedBinariesOnWindows:
      paths:
      - com.unity.formats.alembic/Runtime/Plugins/ARM64/abci.dll
      - com.unity.formats.alembic/Runtime/Plugins/x86_64/abci.dll
  dependencies:
  - path: .yamato/build-alembic-plugins.yml#build_plugins_-_win10
  - path: .yamato/build-alembic-plugins.yml#build_plugins_-_win11-arm64

