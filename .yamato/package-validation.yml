{% metadata_file .yamato/global.metafile %}
---

# The following job validates that the public API files are up to date on Mac
validate_api_osx:
  name : Validate API files on Mac
  agent:
    type: {{ mac_platform.type }}
    image: {{ mac_platform.image }}
    flavor: {{ mac_platform.flavor }}
  commands:
    - git clone git@github.cds.internal.unity3d.com:unity/utr.git utr
    - unity-downloader-cli -u {{ test_editors.first.version }} -c Editor
    - utr/utr --suite=editor --editor-location=.Editor --testproject={{ api_test_project.path }} --artifacts_path=artifacts --reruncount=0
  dependencies:
    - .yamato/package-pack.yml#pack

# The following job validates that the public API files are up to date on Win
validate_api_win:
  name : Validate API files on Win
  agent:
    type: {{ win_platform.type }}
    image: {{ win_platform.image }}
    flavor: {{ win_platform.flavor }}
  commands:
    - git clone git@github.cds.internal.unity3d.com:unity/utr.git utr
    - unity-downloader-cli -u {{ test_editors.first.version }} -c Editor
    - utr/utr.bat --suite=editor --editor-location=.Editor --testproject={{ api_test_project.path }} --artifacts_path=artifacts --reruncount=0
  dependencies:
    - .yamato/package-pack.yml#pack
